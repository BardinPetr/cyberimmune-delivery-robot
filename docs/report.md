# Отчёт о выполнении задачи "Робот-доставщик"

- [Отчёт о выполнении задачи "Робот-доставщик"](#отчёт-о-выполнении-задачи-робот-доставщик)
  - [Постановка задачи](#постановка-задачи)
  - [Известные ограничения и вводные](#известные-ограничения-и-вводные)
    - [Цели и Предположения Безопасности (ЦПБ)](#цели-и-предположения-безопасности-цпб)
      - [Цели](#цели)
      - [Предположения](#предположения)
  - [Архитектура решения](#архитектура-решения)
    - [Компоненты](#компоненты)
      - [Монитор безопасности](#монитор-безопасности-security-monitor)
    - [Алгоритм работы решения](#алгоритм-работы-решения)
    - [Описание cценариев), при которых ЦБ нарушаются](#описание-cценариев-при-которых-цб-нарушаются)
      - [Негативный сценарий 1. ](#негативный-сценарий-1-менеджер-не-проверяет-обновление)
      - [Сводная таблица негативных сценариев](#сводная-таблица-негативных-сценариев)
    - [Указание "доверенных компонент" на архитектурной диаграмме с обоснованием выбора](#указание-доверенных-компонент-на-архитектурной-диаграмме-с-обоснованием-выбора)
    - [Политики безопасности](#политики-безопасности)
  - [Запуск приложения и тестов](#запуск-приложения-и-тестов)
    - [Запуск приложения](#запуск-приложения)
    - [Запуск тестов](#запуск-тестов)

---
## Постановка задачи

Задача заключается в построении безопасной системы управления парком автоматизированных роботов-доставщиков, 
для доставки заказов из интернет-магазина на дом клиенту с возможностью подтверждения личности клиента.

Реализовать прототип вышеописанного решения, в рамках которого
* "робот" получает задание на доставку с параметрами доставки (координаты, PIN)
* имитация сервиса доставки выдаёт информацию "приехал/не приехал" в консоль (механизм автоматического уведомления пользователя о прибытии робота не требуется)
* робот рассчитывает движение, осуществляет его с учётом ограничений и прибывает в место назначения
* также после состояния "приехал" через HMI пользователь может ввести PIN код для получения доступа к хранилищу
* если робот прибыл в место назначения и получил правильный PIN код, срабатывает имитация открытия хранилища (информация отображается в консольном окне)
* после "выдачи заказа" робот должен вернуться на склад и передать статус "доставлено" серверу
* в случае ошибки робот, не открывая хранилище, должен вернуться на склад и передать серверу статус "ошибка"

## Известные ограничения и вводные

1. По условиям организаторов должна использоваться микросервисная архитектура и шина обмена сообщениями для реализации асинхронной работы сервисов.
2. Разработка интернет магазина не требуется, процесс начинается с выдачи системе заказа менеджером склада
3. Разработка графических интерфейсов не требуется, вместо этого допустимо применение любых существующих решений для отправки REST запросов 
4. Для товаров принята модель без размера и веса, возможно заказать любой набор товаров
5. Робот должен иметь возможность функционировать автономно (без соединения с сетью) с момента получения роботом заказа и до возврата на склад


### Цели и Предположения Безопасности (ЦПБ)

#### Цели

1. получение задания только от корпоративного сервера
2. обеспечение сохранности груза до момента передачи авторизованному клиенту
3. обеспечение достижения роботом исходно заданного местоположения
4. невозможность доступа к грузу вне местоположения клиента
5. возврат груза на склад в случае многократных попыток неавторизованного доступа

#### Предположения

1. не рассматриваются атаки, связанные с использованием физического доступа к роботу
2. робот должен иметь возможность функционировать автономно с момента получения задания до возврата на склад
3. монитор безопасности считается доверенным
4. шина сообщений считается доверенной

## Архитектура решения

### Компоненты


| Название                   | Назначение                                                                                        | Комментарий                                                  |
|----------------------------|---------------------------------------------------------------------------------------------------|--------------------------------------------------------------|
| *Fleet management service* | распределяет пользовательские заказы по роботам и обрабатывает статусы заказов                    | единственный сервис облачной части в данном решении          |
| *Communication service*    | осуществляет взаимодействие робота c сервисом управления парком роботов                           | REST взаимодействие с *FMS*                                  |
| *Central control unit*     | основная логика функционирования робота                                                           | взаимодействие со всеми сервисами робота через *MB*          |
| *Positioning*              | определяет местоположение робота                                                                  | имитирует одометрию на основе данных *motion control*        |
| *Motion control*           | осуществляет управление механической частью робота                                                | основная задача - проверка ограничений на параметры движения |
| *Sensors*                  | получает информацию из внешней среды о препятствиях и управляет замком                            | всегда "видит" человека по прибытии на точку заказа          |
| *HMI*                      | осуществляет взаимодействие клиента с роботом                                                     | нет GUI/TUI, только REST запросы                             |
| *Security monitor*         | авторизует операцию, если она удовлетворяет заданным правилам или блокирует её в противном случае |                                                              |
| *Message bus*              | шина сообщений и брокер - сервис передачи сообщений от источника получателям                      | Kafka + Zookeeper                                            |
|
  
![HLA]( "Архитектура")

#### Монитор безопасности

![SM]( "Монитор безопасности")

### Алгоритм работы решения

![Sequence diagram](./diagrams/res/sequence_base.png "Диаграмма вызовов")

### Описание cценариев, при которых ЦБ нарушаются

![Негативные сценарии]("Негативные сценарии")

#### Негативный сценарий 1.

![Негативный сценарий1]("Менеджер не проверяет обновление")

#### Сводная таблица негативных сценариев

### Указание "доверенных компонент" на архитектурной диаграмме с обоснованием выбора

![HLA-TCB]("Доверенные компоненты")

![DFD-TCB]("Доверенные компоненты на диаграмме потоков данных")


### Политики безопасности


```python {lineNo:true}

```

## Запуск приложения и тестов

### Запуск приложения

см. [инструкцию по запуску](../readme.md)

### Запуск тестов
